#웹컴포넌트 만들기

**목차**

- state,setState,render

  - 기능 구현
  - 추상화
  - 모듈화

- 이벤트 처리
- 컴포넌트 분할하기

## state, setState, render 구현

### 기본기능 구현

- 컴포넌트 기반 개발의 핵심은 state를 기반으로 render함수가 실행되어 반영된다는 점이다.

- 꼭 지켜져야 하는 2가지
  - `state`가 변경되면 반드시 `render`함수를 실행한다.
  - `state`는 반드시 `setState`함수를 통해서만 변경해야한다.
- 코드
  - setState는 변경될state를 받아 state를 업데이트하고, 이후 render()함수를 호출한다.
  - render함수는 현재 state를 이용하여 DOM요소를 그려준다.

### 추상화

- 함수로만 작성된 코드를 class 문법을 활용하여 추상화시키기

- 변수 $target, $state

  - Component 클래스는 기본적으로 $target을 인자로 받아, 해당 $target에 해당하는 DOM요소에 요소를 추가하는 구조를 가진다.
  - 컴포넌트별로 자신의 지역상태인 $state를 갖는다.

- setup(), template()
  - setup(): 컴포넌트 생성 시 기본 상태 값 설정등의 초기 세팅을 담당
  - template() : 특정 컴포넌트에서 공통적으로 사용하는 마크업구조를 작성
- render(), setState()
  - state를 반영하여 DOM에 그려주는 render함수
  - state를 변경해주는 setState()함수를 기본적으로 가진다

### 모듈화

- app.js안에 class 문법으로 추상화된 코드를, 각각의 역할에 맞게, 파일별로 모듈화하는 과정

- 컴포넌트를 만드는 core 부분과, Items상태를 가진 Items컴포넌트, Items를 불러오는데 사용하는 App(엔트리포인트)로 구분한다.

**type 모듈이란**

- `<script type="module">`
- [링크](https://eyabc.github.io/Doc/dev/core-javascript/%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80%20%EB%AA%A8%EB%93%88.html#%EB%8B%A8-%ED%95%9C%EB%B2%88%EB%A7%8C-%ED%8F%89%EA%B0%80%EB%90%A8)
- 이 script가 모듈이라는 것을 속성을 통해 명시하는는 것으로 script async, script defer와 같이 생각해볼 수 있음.
- 특징
  - 여러 곳에서 사용되더라도 최초 호출 된 1곳에서만 실행된다.
  - 지연 실행 (defer와 같은 기능)
    - HTML 파서와 병렬적으로 실행되어 script파일을 불러오고, html파싱 이후에 script가 실행된다.
    - 스크립트의 순서가 유지된다
    - 보여지는 요소가 정상동작함을 보장함으로 사용자경험 좋다
    - script async 옵션은 script파일 다운완료와 동시에 실행을 보장한다.
      - 광고, 문서 레벨 이벤트 리스너, 카운터 등 어디에도 종속되지 않는 기능을 구현할 때 유용
      - 종속되는 부분 있을 때는 정상적 동작하지 않는 가능성 존재
- 일반 script와 다른 점
  - 모듈의 최상위 레벨의 this === undefined
    - 일반 script의 최상위 this = window

## 이벤트 처리

    - 필요성 인지하기
        - 하나의 item요소에 삭제,토글등의 기능을 추가한다고 했을 때, 반복적으로 특정요소에 같은 이벤트를 등록/삭제하는 과정이 발생한다.
        - [이벤트 버블링](https://joshua1988.github.io/web-development/javascript/event-propagation-delegation/#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%B2%84%EB%B8%94%EB%A7%81---event-bubbling)활용하여 부모요소($target)에 이벤트를 등록하여 직관적이면서 모든 요소에 쉽게 이벤트핸들링 가능

    - 중요 point
        - event를 각각의 하위 요소가 아니라 component의 target 자체에 등록하는 것이다.
        - 따라서 component가 생성되는 시점에만 이벤트 등록을 해놓으면 추가로 등록할 필요가 없어진다.
            - Component의 constructor에서 setEvent함수 호출하도록 변경

## 컴포넌트 분할하기
